<!DOCTYPE html>
<html lang="en">
<head>
  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Get personalized AI-powered suggestions for food, dress, music, and quotes based on your local weather." />
  <title>AI-Powered Weather Suggestions</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
.dark-mode #favoritesList ul li {
  background: #23272f !important;
  color: #f5f5f5 !important;
  border: 1px solid #444;
}
.dark-mode #favoritesList ul li strong {
  color: #fda085 !important;
}
.dark-mode #favoritesList ul li button {
  background: #fda085 !important;
  color: #23272f !important;
}
    body { background: #f6f7fb; color: #333; font-family: "Segoe UI", Arial, sans-serif; margin: 0; padding: 0; }
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }
    .main-container {
      max-width: 700px;
      margin: 32px auto;
      background: #fff;
      padding: 48px 32px 36px 32px;
      border-radius: 32px;
      box-shadow: 0 16px 48px rgba(253,160,133,0.22), 0 2px 12px rgba(44,125,250,0.10);
      text-align: center;
      width: 96vw;
      box-sizing: border-box;
      transition: background 0.7s cubic-bezier(.77,0,.175,1), color 0.5s;
      animation: fadeInMain 1.2s cubic-bezier(.77,0,.175,1);
    }
    @keyframes fadeInMain { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: none; } }
    header h1 { margin-top: 0; color: #2d7dfa; }
    header h1 { margin-top: 0; color: #f76b1c; font-size: 2.5rem; font-family: 'Montserrat', Arial, sans-serif; letter-spacing: 2px; text-shadow: 0 2px 8px rgba(253,160,133,0.12); animation: fadeInTitle 1.2s cubic-bezier(.77,0,.175,1); }
    @keyframes fadeInTitle { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: none; } }
    button { margin: 0 8px 32px 8px; padding: 14px 24px; font-size: 1.04rem; background: #2d7dfa; color: #fff; border: none; border-radius: 8px; cursor: pointer; transition: background 0.22s; min-width: 180px; }
    button:hover { background: linear-gradient(90deg, #fda085 60%, #f76b1c 100%); box-shadow: 0 6px 24px rgba(253,160,133,0.18); transform: translateY(-2px) scale(1.06); }
    #locationDisplay, #tempDisplay { font-size: 1.05rem; color: #1967d2; margin: 12px 0; }
    #locationDisplay, #tempDisplay { font-size: 1.18rem; color: #f76b1c; margin: 16px 0; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 16px; font-family: 'Montserrat', Arial, sans-serif; letter-spacing: 0.5px; transition: color 0.5s; }
    section#suggestions { display: grid; grid-template-columns: repeat(2, 1fr); gap: 28px; width: 100%; box-sizing: border-box; margin-top: 18px; }
    .suggestion-card { background: #f0f6ff; border-radius: 12px; padding: 18px 14px; box-shadow: 0 2px 9px rgba(44,125,250,0.04); min-height: 120px; display: flex; flex-direction: column; justify-content: center; width: auto; box-sizing: border-box; }
    .suggestion-card { background: linear-gradient(120deg, #f0f6ff 0%, #fda085 100%); border-radius: 18px; padding: 28px 18px; box-shadow: 0 8px 32px rgba(253,160,133,0.10), 0 2px 12px rgba(44,125,250,0.08); min-height: 120px; display: flex; flex-direction: column; justify-content: center; width: auto; box-sizing: border-box; transition: box-shadow 0.22s, transform 0.18s, background 0.5s; animation: fadeInCard 1.2s cubic-bezier(.77,0,.175,1); }
    .suggestion-card:hover { box-shadow: 0 16px 48px rgba(253,160,133,0.18); transform: translateY(-2px) scale(1.04); background: linear-gradient(120deg, #fda085 0%, #f0f6ff 100%); }
    .suggestion-card h2 { margin: 0; font-size: 1.22rem; color: #f76b1c; font-weight: bold; letter-spacing: 1px; font-family: 'Montserrat', Arial, sans-serif; }
    .suggestion-card .result { font-size: 1.03rem; color: #333; margin-top: 8px; min-height: 40px; }
    #errorMsg { margin-top: 20px; color: #b00020; font-weight: 600; }
    .spinner { display: none; margin: 18px auto; border: 6px solid #f3f3f3; border-top: 6px solid #2d7dfa; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    .suggestion-card .result { font-size: 1.13rem; color: #333; margin-top: 12px; min-height: 40px; font-family: 'Roboto', Arial, sans-serif; letter-spacing: 0.5px; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .dark-mode { background: #181a20; color: #f5f5f5; }
    .dark-mode { background: linear-gradient(120deg, #23272f 0%, #181a20 100%); color: #f5f5f5; transition: background 0.7s cubic-bezier(.77,0,.175,1), color 0.5s; }
    .dark-mode .main-container { background: #23272f; color: #f5f5f5; transition: background 0.7s cubic-bezier(.77,0,.175,1), color 0.5s; }
    .dark-mode .suggestion-card { background: #23272f; color: #f5f5f5; border: 1px solid #444; }
    .dark-mode header h1 { color: #64b5f6; }
    .dark-mode header p { color: #b0bec5; }
    .dark-mode #locationDisplay, .dark-mode #tempDisplay { color: #90caf9; }
    .dark-mode #errorMsg { color: #ff5252; }
    .dark-mode button { background: #1976d2; color: #fff; border: none; }
    .dark-mode button:hover { background: #1565c0; color: #fff; }
    .dark-mode input { background: #23272f; color: #f5f5f5; border: 1px solid #444; }
    .dark-mode footer { color: #b0bec5; }
    @media (max-width: 650px) {
      body { padding: 0; }
      .main-container { padding: 18px 4px 16px 4px; margin: 8px auto; border-radius: 18px; }
      section#suggestions { grid-template-columns: 1fr; }
      header h1 { font-size: 1.4rem; }
    }
    @media (max-width: 650px) { section#suggestions { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <!-- Theme switcher removed as requested -->
  <div class="main-container">
    <header>
      <h1>What’s the Vibe Today?</h1>
      <p>Get personalized suggestions powered by AI based on your weather</p>
    </header>
    <div style="display: flex; justify-content: flex-end; align-items: center; margin-bottom: 8px;">
      <button id="toggleDarkMode" style="margin:0 0 0 8px; padding:8px 18px; font-size:1.1rem; border-radius:24px; background:linear-gradient(90deg,#23272f 60%,#fda085 100%); color:#fff; border:none; box-shadow:0 2px 8px rgba(44,125,250,0.08); cursor:pointer;">🌙 Dark Mode</button>
    </div>
    <div id="greetingContainer" style="margin-bottom:18px;">
      <label for="userName" style="font-size:1.08rem;">Your Name:</label>
      <input type="text" id="userName" aria-label="Enter your name" style="padding:8px 14px; border-radius:8px; border:1.5px solid #fda085; font-size:1.05rem; margin-left:8px;">
      <button id="saveNameBtn" style="padding:8px 16px; border-radius:8px; background:#f76b1c; color:#fff; border:none; cursor:pointer;">Save</button>
      <span id="userGreeting" style="margin-left:16px; font-size:1.12rem; font-weight:500;"></span>
    </div>
    <button id="getLocationBtn" aria-label="Get personalized suggestions based on your weather">Get My Suggestions</button>
    <div style="margin:18px 0;">
      <input type="text" id="manualLocation" placeholder="Enter city or location" style="padding:8px 12px;border-radius:6px;border:1px solid #ccc;max-width:220px;">
      <button id="manualLocationBtn" style="padding:8px 16px;border-radius:6px;background:#2d7dfa;color:#fff;border:none;cursor:pointer;">Use Location</button>
    </div>
    <div class="spinner" id="spinner"></div>
    <p id="locationDisplay">Location: ---</p>
    <p id="tempDisplay">Temperature: ---°C</p>
    <section id="suggestions">
  <div id="forecastContainer" style="margin:24px 0;"></div>
  <button id="viewFavBtn" aria-label="View saved favorites" style="margin:8px auto;display:block;padding:10px 18px;border-radius:8px;background:#64b5f6;color:#fff;border:none;cursor:pointer;">View Favorites</button>
  <div id="favoritesList" style="margin:16px 0;"></div>
      <div class="suggestion-card" id="food">
        <h2>Food to Eat</h2>
        <p class="result">---</p>
      </div>
      <div class="suggestion-card" id="dress">
        <h2>Dress to Wear</h2>
        <p class="result">---</p>
      </div>
      <div class="suggestion-card" id="music">
        <h2>Music to Listen</h2>
        <p class="result">---</p>
      </div>
      <div class="suggestion-card" id="activities">
        <h2>Activity Suggestion</h2>
        <p class="result">---</p>
      </div>
      <div class="suggestion-card" id="quote">
        <h2>Quote for the Day</h2>
        <p class="result">---</p>
      </div>
    </section>
    <p id="errorMsg"></p>
    <button id="saveFavBtn" aria-label="Save these suggestions" style="margin:18px auto;display:block;padding:10px 18px;border-radius:8px;background:#f76b1c;color:#fff;border:none;cursor:pointer;">Save Favorite</button>
    <button id="shareBtn" style="margin:8px auto;display:block;padding:10px 18px;border-radius:8px;background:#2d7dfa;color:#fff;border:none;cursor:pointer;">Copy Suggestions</button>
    <div style="display:flex;justify-content:center;gap:12px;margin-bottom:18px;">
      <button id="twitterShareBtn" aria-label="Share on Twitter" style="padding:8px 16px;border-radius:8px;background:#1da1f2;color:#fff;border:none;cursor:pointer;">Share on Twitter</button>
      <button id="whatsappShareBtn" aria-label="Share on WhatsApp" style="padding:8px 16px;border-radius:8px;background:#25d366;color:#fff;border:none;cursor:pointer;">Share on WhatsApp</button>
    </div>
    <footer>
      <small>&copy; 2025 YourWebsiteName</small>
    </footer>
  </div>
  <script>
  const forecastContainer = document.getElementById('forecastContainer');
  const viewFavBtn = document.getElementById('viewFavBtn');
  const favoritesList = document.getElementById('favoritesList');
  // Theme switcher code removed

    // Animated weather icon (simple SVG)
    function getAnimatedIcon(desc) {
      if(desc.toLowerCase().includes('rain')) {
        return <svg width="48" height="48"><ellipse cx="24" cy="20" rx="16" ry="10" fill="#90caf9"/><line x1="18" y1="32" x2="18" y2="40" stroke="#2196f3" stroke-width="3"/><line x1="30" y1="32" x2="30" y2="40" stroke="#2196f3" stroke-width="3"/></svg>;
      } else if(desc.toLowerCase().includes('cloud')) {
        return <svg width="48" height="48"><ellipse cx="24" cy="24" rx="16" ry="10" fill="#b0bec5"/></svg>;
      } else {
        return <svg width="48" height="48"><circle cx="24" cy="24" r="12" fill="#ffd600"/></svg>;
      }
    }

    // Daily background image based on weather
    function setDailyBackground(desc) {
      if(desc.toLowerCase().includes('rain')) {
        document.body.style.background = 'linear-gradient(120deg,#90caf9 0%,#2196f3 100%)';
      } else if(desc.toLowerCase().includes('cloud')) {
        document.body.style.background = 'linear-gradient(120deg,#b0bec5 0%,#eceff1 100%)';
      } else {
        document.body.style.background = 'linear-gradient(120deg,#f6d365 0%,#ffd600 100%)';
      }
    }

    // Voice assistant (speak suggestions)
    function speakSuggestions() {
      let text = '';
      text += document.getElementById('locationDisplay').textContent + '. ';
      text += document.getElementById('tempDisplay').textContent + '. ';
      text += 'Food: ' + document.querySelector('#food .result').textContent + '. ';
      text += 'Dress: ' + document.querySelector('#dress .result').textContent + '. ';
      text += 'Music: ' + document.querySelector('#music .result').textContent + '. ';
      text += 'Activity: ' + document.querySelector('#activities .result').textContent + '. ';
      text += 'Quote: ' + document.querySelector('#quote .result').textContent + '.';
      const utter = new window.SpeechSynthesisUtterance(text);
      window.speechSynthesis.speak(utter);
    }

    // Add a button for voice assistant
    const voiceBtn = document.createElement('button');
    voiceBtn.textContent = '🔊 Speak Suggestions';
    voiceBtn.setAttribute('aria-label','Speak suggestions aloud');
    voiceBtn.style.margin = '8px auto';
    voiceBtn.style.display = 'block';
    voiceBtn.style.padding = '10px 18px';
    voiceBtn.style.borderRadius = '8px';
    voiceBtn.style.background = '#ffd600';
    voiceBtn.style.color = '#333';
    voiceBtn.style.border = 'none';
    voiceBtn.style.cursor = 'pointer';
    document.querySelector('section#suggestions').appendChild(voiceBtn);
    voiceBtn.addEventListener('click', speakSuggestions);

    // View/manage saved favorites
    viewFavBtn.addEventListener('click', () => {
      let favs = JSON.parse(localStorage.getItem('favoriteSuggestions') || '[]');
      if(favs.length === 0) {
        favoritesList.innerHTML = '<p>No favorites saved yet.</p>';
        return;
      }
      let html = '<ul style="list-style:none;padding:0;">';
      favs.forEach((fav, idx) => {
        html += <li style='margin-bottom:12px;padding:12px 18px;background:#fff8f0;border-radius:10px;box-shadow:0 2px 8px rgba(253,160,133,0.08);'>
          + <strong>${fav.location}</strong><br>${fav.temp}<br>Food: ${fav.food}<br>Dress: ${fav.dress}<br>Music: ${fav.music}<br>Activity: ${fav.activity}<br>Quote: ${fav.quote}
          + <br><button data-idx='${idx}' style='margin-top:8px;padding:6px 12px;border-radius:6px;background:#f76b1c;color:#fff;border:none;cursor:pointer;'>Delete</button>
          + </li>;
      });
      html += '</ul>';
      favoritesList.innerHTML = html;
      // Delete favorite
      favoritesList.querySelectorAll('button[data-idx]').forEach(btn => {
        btn.addEventListener('click', function() {
          let favs = JSON.parse(localStorage.getItem('favoriteSuggestions') || '[]');
          favs.splice(this.getAttribute('data-idx'),1);
          localStorage.setItem('favoriteSuggestions', JSON.stringify(favs));
          viewFavBtn.click();
        });
      });
    });
    const OPENWEATHER_KEY = "492c9d79ee712c7725deec68fe9be572";
  const spinner = document.getElementById('spinner');
  const errorMsg = document.getElementById('errorMsg');
  const getLocationBtn = document.getElementById('getLocationBtn');
  const manualLocationBtn = document.getElementById('manualLocationBtn');
  const manualLocationInput = document.getElementById('manualLocation');
  const shareBtn = document.getElementById('shareBtn');
  const saveFavBtn = document.getElementById('saveFavBtn');
  const twitterShareBtn = document.getElementById('twitterShareBtn');
  const whatsappShareBtn = document.getElementById('whatsappShareBtn');
  const toggleDarkModeBtn = document.getElementById('toggleDarkMode');
  const userNameInput = document.getElementById('userName');
  const saveNameBtn = document.getElementById('saveNameBtn');
  const userGreeting = document.getElementById('userGreeting');
  let lastSuggestions = null;
    // Accessibility: focus on first input
    window.onload = function() {
      loadSuggestions();
      userNameInput.focus();
      if(localStorage.getItem('userName')) {
        userGreeting.textContent = Hello, ${localStorage.getItem('userName')}!;
      }
    };

    saveNameBtn.addEventListener('click', () => {
      const name = userNameInput.value.trim();
      if(name) {
        localStorage.setItem('userName', name);
        userGreeting.textContent = Hello, ${name}!;
        userNameInput.value = '';
      }
    });

    userNameInput.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') saveNameBtn.click();
    });
    // Save favorite suggestions
    saveFavBtn.addEventListener('click', () => {
      if(lastSuggestions) {
        let favs = JSON.parse(localStorage.getItem('favoriteSuggestions') || '[]');
        favs.push(lastSuggestions);
        localStorage.setItem('favoriteSuggestions', JSON.stringify(favs));
        alert('Suggestions saved as favorite!');
      } else {
        alert('No suggestions to save.');
      }
    });

    // Share to Twitter
    twitterShareBtn.addEventListener('click', () => {
      let text = '';
      text += document.getElementById('locationDisplay').textContent + '\n';
      text += document.getElementById('tempDisplay').textContent + '\n';
      text += 'Food: ' + document.querySelector('#food .result').textContent + '\n';
      text += 'Dress: ' + document.querySelector('#dress .result').textContent + '\n';
      text += 'Music: ' + document.querySelector('#music .result').textContent + '\n';
      text += 'Activity: ' + document.querySelector('#activities .result').textContent + '\n';
      text += 'Quote: ' + document.querySelector('#quote .result').textContent + '\n';
      const url = https://twitter.com/intent/tweet?text=${encodeURIComponent(text)};
      window.open(url, '_blank');
    });

    // Share to WhatsApp
    whatsappShareBtn.addEventListener('click', () => {
      let text = '';
      text += document.getElementById('locationDisplay').textContent + '\n';
      text += document.getElementById('tempDisplay').textContent + '\n';
      text += 'Food: ' + document.querySelector('#food .result').textContent + '\n';
      text += 'Dress: ' + document.querySelector('#dress .result').textContent + '\n';
      text += 'Music: ' + document.querySelector('#music .result').textContent + '\n';
      text += 'Activity: ' + document.querySelector('#activities .result').textContent + '\n';
      text += 'Quote: ' + document.querySelector('#quote .result').textContent + '\n';
      const url = https://wa.me/?text=${encodeURIComponent(text)};
      window.open(url, '_blank');
    });

    function showSpinner(show) { spinner.style.display = show ? 'block' : 'none'; }
    function saveSuggestions(suggestions) { localStorage.setItem('lastSuggestions', JSON.stringify(suggestions)); }
    function loadSuggestions() {
      const data = localStorage.getItem('lastSuggestions');
      if (data) {
        const s = JSON.parse(data);
        document.getElementById('locationDisplay').textContent = s.location;
        document.getElementById('tempDisplay').textContent = s.temp;
        document.querySelector('#food .result').textContent = s.food;
        document.querySelector('#dress .result').textContent = s.dress;
        document.querySelector('#music .result').textContent = s.music;
        document.querySelector('#quote .result').textContent = s.quote;
        document.querySelector('#activities .result').textContent = s.activity;
        document.getElementById('weatherIcon')?.remove();
        if (s.iconUrl) {
          const icon = document.createElement('img');
          icon.id = 'weatherIcon';
          icon.src = s.iconUrl;
          icon.alt = s.weatherDesc;
          icon.style.height = '48px';
          icon.style.verticalAlign = 'middle';
          document.getElementById('locationDisplay').appendChild(icon);
        }
      }
    }
    window.onload = loadSuggestions;

    getLocationBtn.addEventListener('click', () => {
      errorMsg.textContent = '';
      if (!navigator.geolocation) {
        errorMsg.textContent = 'Geolocation is not supported by your browser.';
        return;
      }
      showSpinner(true);
      navigator.geolocation.getCurrentPosition(success, error);
      function success(position) {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;
        fetchWeatherAndAI({lat: latitude, lon: longitude});
      }
      function error() {
        showSpinner(false);
        errorMsg.textContent = "Unable to retrieve your location.";
      }
    });

    manualLocationBtn.addEventListener('click', () => {
      errorMsg.textContent = '';
      const loc = manualLocationInput.value.trim();
      if (!loc) {
        errorMsg.textContent = 'Please enter a location.';
        return;
      }
      showSpinner(true);
      fetchWeatherAndAI({city: loc});
    });

    toggleDarkModeBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
    });

    shareBtn.addEventListener('click', () => {
      let text = '';
      text += document.getElementById('locationDisplay').textContent + '\\n';
      text += document.getElementById('tempDisplay').textContent + '\\n';
      text += 'Food: ' + document.querySelector('#food .result').textContent + '\\n';
      text += 'Dress: ' + document.querySelector('#dress .result').textContent + '\\n';
      text += 'Music: ' + document.querySelector('#music .result').textContent + '\\n';
      text += 'Activity: ' + document.querySelector('#activities .result').textContent + '\\n';
      text += 'Quote: ' + document.querySelector('#quote .result').textContent + '\\n';
      navigator.clipboard.writeText(text).then(() => {
        alert('Suggestions copied to clipboard!');
      });
    });

    async function fetchWeatherAndAI({lat, lon, city}) {
      try {
        let url = '';
        if (lat && lon) {
          url = https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${OPENWEATHER_KEY}&units=metric;
        } else if (city) {
          url = https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&appid=${OPENWEATHER_KEY}&units=metric;
        } else {
          throw new Error('No location provided.');
        }
        const response = await fetch(url);
        showSpinner(false);
        const data = await response.json();
        if (response.status === 404 || data.cod === "404") {
          throw new Error('City not found. Please check the spelling or try a different location.');
        }
        if (response.status === 401 || data.cod === 401) {
          throw new Error('Invalid API key. Please check your OpenWeather API key.');
        }
        if (!response.ok || !data.main || !data.weather || !data.name) {
          throw new Error('Could not get weather data. Try again later.');
        }
  const temp = data.main.temp;
  const desc = data.weather[0].main || '';
  const iconUrl = data.weather[0].icon ? https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png : null;
  document.getElementById('locationDisplay').textContent = Location: ${data.name}, ${data.sys.country};
  document.getElementById('tempDisplay').textContent = Temperature: ${temp}°C;
  document.getElementById('weatherIcon')?.remove();
  // Animated SVG icon
  const iconDiv = document.createElement('span');
  iconDiv.id = 'weatherIcon';
  iconDiv.innerHTML = getAnimatedIcon(desc);
  iconDiv.style.marginLeft = '12px';
  iconDiv.style.display = 'inline-block';
  document.getElementById('locationDisplay').appendChild(iconDiv);
  // Set daily background
  setDailyBackground(desc);
        // 3-day forecast
        let forecastHtml = '<h3 style="color:#f76b1c;font-family:Montserrat,Arial,sans-serif;">3-Day Forecast</h3>';
        let forecastUrl = '';
        if(lat && lon) {
          forecastUrl = https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&appid=${OPENWEATHER_KEY}&units=metric;
        } else if(city) {
          forecastUrl = https://api.openweathermap.org/data/2.5/forecast?q=${encodeURIComponent(city)}&appid=${OPENWEATHER_KEY}&units=metric;
        }
        if(forecastUrl) {
          const forecastRes = await fetch(forecastUrl);
          if(forecastRes.ok) {
            const forecastData = await forecastRes.json();
            // Get next 3 days (every 24h, so 8*3=24h intervals)
            let days = [];
            let today = new Date().getDate();
            forecastData.list.forEach(item => {
              let date = new Date(item.dt_txt);
              if(date.getDate() !== today && days.length < 3 && !days.find(d => d.date === date.toDateString())) {
                days.push({
                  date: date.toDateString(),
                  temp: item.main.temp,
                  desc: item.weather[0].main,
                  icon: item.weather[0].icon
                });
              }
            });
            forecastHtml += '<div style="display:flex;justify-content:center;gap:18px;">';
            days.forEach(day => {
              forecastHtml += <div style='background:#fff8f0;border-radius:12px;padding:12px 18px;box-shadow:0 2px 8px rgba(253,160,133,0.08);min-width:120px;'>
                + <div style='font-weight:600;color:#f76b1c;'>${day.date.split(' ').slice(0,3).join(' ')}</div>
                + <img src='https://openweathermap.org/img/wn/${day.icon}@2x.png' alt='${day.desc}' style='height:48px;width:48px;display:block;margin:0 auto;'>
                + <div style='font-size:1.08rem;color:#333;'>${day.temp}°C</div>
                + <div style='font-size:0.98rem;color:#555;'>${day.desc}</div>
                + </div>;
            });
            forecastHtml += '</div>';
            forecastContainer.innerHTML = forecastHtml;
          }
        }
        const food = suggestFood(temp);
        const dress = suggestDress(temp, desc);
        const music = suggestMusic(desc);
        const quote = suggestQuote();
        const activity = suggestActivity(temp, desc);
        document.querySelector('#food .result').textContent = food;
        document.querySelector('#dress .result').textContent = dress;
        document.querySelector('#music .result').textContent = music;
        document.querySelector('#quote .result').textContent = quote;
        document.querySelector('#activities .result').textContent = activity;
        lastSuggestions = {
          location: Location: ${data.name}, ${data.sys.country},
          temp: Temperature: ${temp}°C,
          food, dress, music, quote, activity,
          iconUrl, weatherDesc: desc
        };
        saveSuggestions(lastSuggestions);
      } catch (err) {
        showSpinner(false);
        errorMsg.textContent = err.message || 'Unable to load weather data.';
        document.getElementById('locationDisplay').textContent = 'Location: ---';
        document.getElementById('tempDisplay').textContent = 'Temperature: ---°C';
        document.querySelector('#food .result').textContent = '---';
        document.querySelector('#dress .result').textContent = '---';
        document.querySelector('#music .result').textContent = '---';
        document.querySelector('#quote .result').textContent = '---';
        document.querySelector('#activities .result').textContent = '---';
        document.getElementById('weatherIcon')?.remove();
      }
    }

    function suggestFood(temp) {
      const foodsHot = [
        'Lemongrass iced tea and watermelon salad',
        'Coconut water and cucumber raita',
        'Cold curd rice with pickle'
      ];
      const foodsWarm = [
        'Fresh mango lassi and masala papad',
        'Paneer tikka and chilled nimbu pani',
        'Fruit chaat and iced filter coffee'
      ];
      const foodsCold = [
        'Hot rasam and idli combo',
        'Vegetable soup with toasted bread',
        'Spicy sambar rice'
      ];
      const arr = temp > 30 ? foodsHot : temp > 20 ? foodsWarm : foodsCold;
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function suggestDress(temp, desc) {
      const dressesRain = [
        'Umbrella, waterproof jacket, and rubber sandals',
        'Raincoat with quick-dry pants',
        'Windcheater and boots'
      ];
      const dressesHot = [
        'Sleeveless kurti and linen pants',
        'Light cotton saree',
        'Short sleeves and shorts'
      ];
      const dressesWarm = [
        'Jeans and cotton shirt',
        'Half-sleeve t-shirt and chinos',
        'Casual kurta and leggings'
      ];
      const dressesCold = [
        'Hoodie and thick jeans',
        'Woolen sweater with warm scarf',
        'Thermal inners and jacket'
      ];
      if (desc.toLowerCase().includes('rain')) {
        const arr = dressesRain;
        return arr[Math.floor(Math.random() * arr.length)];
      }
      const arr = temp > 30 ? dressesHot : temp > 20 ? dressesWarm : dressesCold;
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function suggestMusic(desc) {
      const songsClear = [
        'Munbe Vaa (Sillunu Oru Kaadhal)',
        'Ennai Vittu Pogaathe (Darbar)',
        'Vinnaithaandi Varuvaayaa Theme'
      ];
      const songsRain = [
        'Pudhu Metro Rail (Oh Kadhal Kanmani)',
        'Mazhai Kuruvi (Chekka Chivantha Vaanam)',
        'Nenjukulle (Kadal)'
      ];
      const songsCloudy = [
        'Oru Deivam Thantha Poove (Kanathil Muthamittal)',
        'Thuli Thuli Mazhaiyaai (Paiyaa)',
        'Poi Solla Kudathu (Run)'
      ];
      let arr = songsClear;
      if (desc.toLowerCase().includes('rain')) arr = songsRain;
      else if (desc.toLowerCase().includes('cloud')) arr = songsCloudy;
      return 'Listen to: “' + arr[Math.floor(Math.random() * arr.length)] + '”';
    }

    function suggestQuote() {
      const quotes = [
        'Seize this bright moment!',
        'Let every drop inspire you.',
        'Dance with the rhythm of the weather.',
        'Nature’s moods are amazing. Embrace them!',
        'Find joy whatever the sky brings.',
        'Today is your canvas. Paint it vibrant.'
      ];
      return quotes[Math.floor(Math.random() * quotes.length)];
    }

    function suggestActivity(temp, desc) {
      const activitiesRain = [
        'Read a book by the window',
        'Watch a cozy movie',
        'Try indoor yoga'
      ];
      const activitiesHot = [
        'Go for a swim',
        'Try a cold dessert recipe',
        'Visit an air-conditioned mall'
      ];
      const activitiesWarm = [
        'Take a walk in the park',
        'Go cycling',
        'Try outdoor painting'
      ];
      const activitiesCold = [
        'Bake cookies',
        'Do a home workout',
        'Watch a documentary'
      ];
      if (desc.toLowerCase().includes('rain')) {
        return activitiesRain[Math.floor(Math.random() * activitiesRain.length)];
      }
      const arr = temp > 30 ? activitiesHot : temp > 20 ? activitiesWarm : activitiesCold;
      return arr[Math.floor(Math.random() * arr.length)];
    }
  </script>
</body>
</html>
